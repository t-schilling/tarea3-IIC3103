{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea3-IIC3103/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _slicedToArray from \"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea3-IIC3103/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea3-IIC3103/src/componentes/Info.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport socket from './Socket';\nimport { MapContainer, TileLayer, Polyline, Tooltip, Marker, Circle } from 'react-leaflet';\nimport './Map.css';\nimport './../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Info = function Info() {\n  _s();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      trucks = _useState2[0],\n      setTrucks = _useState2[1];\n\n  var _useState3 = useState([[]]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      positions = _useState4[0],\n      setPosition = _useState4[1];\n\n  useEffect(function () {\n    socket.on('TRUCKS', function (truck) {\n      var _iterator = _createForOfIteratorHelper(truck),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var camion = _step.value;\n\n          if (camion.position == undefined) {\n            camion.position = [0, 0];\n          }\n\n          ;\n\n          if (camion.status == undefined) {\n            camion.status = 'Unknown';\n          }\n\n          ;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      setTrucks(trucks.concat(truck));\n    });\n    return function () {\n      socket.off('TRUCKS');\n    };\n  }, [trucks]);\n  useEffect(function () {\n    socket.on('POSITION', function (obj) {\n      setPosition(positions.concat([{\n        code: obj.code,\n        position: obj.position\n      }]));\n      var truck = trucks.find(function (element) {\n        return element.code === obj.code;\n      });\n\n      if (truck === undefined) {\n        console.log('[POSITION] codigo camion buscado: ' + obj.code);\n        console.log(\"[POSITION]  Truck not found\");\n      } else {\n        truck.position = obj.position; //console.log('[POSITION]  Nueva posicion de: ' + obj.code + '<->' + obj.position);\n      }\n    });\n    return function () {\n      socket.off('POSITION');\n    };\n  });\n  useEffect(function () {\n    socket.on('FAILURE', function (_ref) {\n      var code = _ref.code,\n          source = _ref.source;\n      var truck = trucks.find(function (element) {\n        return element.code === code;\n      });\n\n      if (typeof truck === undefined) {\n        return \"Truck not found\";\n      } else {\n        truck.status = source;\n      }\n    });\n    return function () {\n      socket.off('FAILURE');\n    };\n  });\n  useEffect(function () {\n    socket.on('FIX', function (truck_object) {\n      var truck = trucks.find(function (element) {\n        return element.code === truck_object.code;\n      });\n\n      if (typeof truck === undefined) {\n        return \"Truck not found\";\n      } else {\n        truck.status = 'Ok';\n      }\n    });\n    return function () {\n      socket.off('FIX');\n    };\n  });\n\n  var truckInfo = function truckInfo(code) {\n    var truck = trucks.find(function (element) {\n      return element.code === code;\n    }); //console.log(truck)\n\n    if (truck === undefined) {\n      return \"Truck not found\";\n    } //console.log('ahora tenemos' + truck)\n\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"'Truck:' \", truck.truck]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 42\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"'Code: '\", truck.code]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 40\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"'Origin: '\", truck.origin, \"'\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 45\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Destination: '\", truck.destination]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 53\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"'Actual Position: '\", truck.position]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 55\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"'Status: '\", truck.status]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }, _this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 45\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 17\n    }, _this);\n  };\n\n  var fixTruck = function fixTruck(e) {\n    console.log('[fixTruck] Yo reparando el siguiente camion: ' + e);\n    socket.emit('FIX', {\n      code: e\n    });\n  };\n\n  var changeStatus = function changeStatus() {\n    var _iterator2 = _createForOfIteratorHelper(trucks),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var element = _step2.value;\n\n        if (element.status == undefined || element.status == '') {\n          element.status = 'Ok';\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mapArea\",\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: [-21.976193, -68.79],\n        zoom: 11,\n        scrollWheelZoom: false,\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 17\n        }, _this), trucks.map(function (dat) {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Polyline, {\n              pathOptions: {\n                color: 'black'\n              },\n              positions: [dat.origin, dat.destination]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 25\n            }, _this)\n          }, dat.code, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 25\n          }, _this);\n        }), trucks.map(function (data) {\n          console.log('[MAP]: primer print posiciones' + data.code + '->' + data.position);\n\n          if (data.position === undefined) {\n            console.log('[MAP] error encontrando posiciones');\n            return '';\n          } else {\n            console.log('[MAP] posiciones encontradas: ' + data.code + '->' + data.position);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(Marker, {\n                center: (data.position[0], data.position[1]),\n                radius: 100,\n                children: /*#__PURE__*/_jsxDEV(Tooltip, {\n                  children: [console.log('[MAP]'), truckInfo(data.code)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 127,\n                  columnNumber: 37\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 33\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 29\n            }, _this);\n          }\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"infoArea\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"info_titulo\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Trucks Information:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 22\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 17\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"solo_info\",\n          children: trucks.map(function (e, i) {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"truckInfo_container\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [\"Truck: \", e.truck]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 25\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [\"Code: \", e.code]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 154,\n                    columnNumber: 25\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [\"Origin: \", e.origin, \" \"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 155,\n                    columnNumber: 25\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [\"Destination: \", e.destination, \" \"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 156,\n                    columnNumber: 25\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [\"Status: \", e.status, \" \"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 25\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: e.status !== ('Ok' || 'Unknown') && /*#__PURE__*/_jsxDEV(\"button\", {\n                      value: e.code,\n                      onClick: function onClick(a) {\n                        return fixTruck(a.target.value);\n                      },\n                      children: \"Fix Truck\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 160,\n                      columnNumber: 29\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 25\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 25\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 21\n              }, _this)\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 42\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 17\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 13\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(Info, \"k+fcIg2SsXT9mZGua9ofNxUNLZM=\");\n\n_c = Info;\nexport default Info;\n\nvar _c;\n\n$RefreshReg$(_c, \"Info\");","map":{"version":3,"sources":["/home/thomas/Desktop/XII Semestre/Taller de IntegraciÃ³n/Tarea 3/tarea3-IIC3103/src/componentes/Info.js"],"names":["React","useState","useEffect","socket","MapContainer","TileLayer","Polyline","Tooltip","Marker","Circle","Info","trucks","setTrucks","positions","setPosition","on","truck","camion","position","undefined","status","concat","off","obj","code","find","element","console","log","source","truck_object","truckInfo","origin","destination","fixTruck","e","emit","changeStatus","map","dat","color","data","i","a","target","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport socket from './Socket';\nimport { MapContainer, TileLayer, Polyline, Tooltip, Marker, Circle} from 'react-leaflet';\nimport './Map.css';\nimport './../App.css'\n\nconst Info = () => {\n\n    const[trucks, setTrucks] = useState([]);\n    const[positions, setPosition] = useState([[]]);\n\n    \n    useEffect(() => {\n        socket.on('TRUCKS', truck =>{\n            for (let camion of truck){\n                if(camion.position == undefined){\n                    camion.position = [0,0];\n                };\n                if(camion.status == undefined){\n                    camion.status = 'Unknown';\n                };\n            }\n            setTrucks(trucks.concat(truck));\n        });\n        return () => {socket.off('TRUCKS')};\n    },[trucks]);\n\n    useEffect(() => {\n        socket.on( 'POSITION', (obj) => {setPosition(positions.concat([{code: obj.code, position : obj.position}]));\n        let truck  = trucks.find(element => element.code === obj.code);\n            if (truck === undefined){\n                console.log('[POSITION] codigo camion buscado: ' + obj.code)\n                console.log( \"[POSITION]  Truck not found\");\n            }\n            else{\n                truck.position = obj.position;\n                //console.log('[POSITION]  Nueva posicion de: ' + obj.code + '<->' + obj.position);\n            } \n        });\n        return () => {socket.off('POSITION')};\n    });\n\n    useEffect(() => {\n        socket.on('FAILURE', ({code, source}) => { \n            let truck  = trucks.find(element => element.code === code);\n            if (typeof(truck) === undefined){\n                return \"Truck not found\";\n            }\n            else{\n                truck.status = source;\n            }\n        });\n        return () => {socket.off('FAILURE')}\n    });\n\n    useEffect(() => {\n        socket.on('FIX', (truck_object) =>{\n            let truck  = trucks.find(element => element.code === truck_object.code);\n            if (typeof(truck) === undefined){\n                return \"Truck not found\";\n            }\n            else{\n                truck.status = 'Ok';\n            }\n        });\n        return () => {socket.off('FIX')}\n    });\n\n    const truckInfo = (code) => {\n        let truck  = trucks.find(element => element.code === code);\n        //console.log(truck)\n        if (truck === undefined){\n            return (\"Truck not found\");\n        }\n        //console.log('ahora tenemos' + truck)\n        return (<div>\n            <p>'Truck:' {truck.truck}</p><br />\n            <p>'Code: '{truck.code}</p><br />\n            <p>'Origin: '{truck.origin}'</p><br />\n            <p>Destination: '{truck.destination}</p><br />\n            <p>'Actual Position: '{truck.position}</p><br /> \n            <p>'Status: '{truck.status}</p> <br />\n        </div>)   \n    };\n\n    const fixTruck = (e) =>{\n        console.log('[fixTruck] Yo reparando el siguiente camion: ' + e);\n        socket.emit('FIX', {code : e});\n    }\n\n    const changeStatus = () => {\n        for (let element of trucks){\n            if(element.status == undefined || element.status == ''){\n                element.status = 'Ok';\n            }\n        }\n    }\n\n    return (\n        <div>\n            <div className=\"mapArea\">\n                <MapContainer center={[-21.976193,-68.79]} zoom={11} scrollWheelZoom={false}>\n                <TileLayer\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                />\n\n                {trucks.map((dat) => {\n                    return (\n                        <div key={dat.code}>\n                        <Polyline pathOptions={{color:'black'}} positions={[dat.origin, dat.destination]} />\n                        </div>\n                    )\n                })}\n                \n                {trucks.map((data) => {\n                    console.log('[MAP]: primer print posiciones' + data.code + '->'+  data.position)\n                    if(data.position === undefined){\n                        console.log('[MAP] error encontrando posiciones')\n                        return('')\n                    }\n                    else{\n                    console.log('[MAP] posiciones encontradas: '+ data.code + '->'+  data.position)\n                        return (\n                            <div >\n                                <Marker center={data.position[0], data.position[1]} radius={100}>\n                                    <Tooltip>\n                                        {console.log('[MAP]')}\n                                        {truckInfo(data.code)}                                \n                                    </Tooltip>\n                                </Marker>\n                            </div>\n                        )\n                    }\n                })}\n                \n                \n                \n            \n                    \n                </MapContainer>\n            </div>\n\n\n            \n        <div className=\"infoArea\">\n            <div className=\"info_titulo\">\n                <div><h2>Trucks Information:</h2></div>\n                <div className=\"solo_info\"> \n                    {trucks.map((e,i) => <div  key={i}> \n                    <div> \n                        <div className='truckInfo_container'>\n                        <div>Truck: {e.truck}</div>\n                        <div>Code: {e.code}</div>\n                        <div>Origin: {e.origin} </div>\n                        <div>Destination: {e.destination} </div>\n                        <div>Status: {e.status} </div>\n                        <div>\n                        {(e.status !== (('Ok') || ('Unknown'))) && \n                            <button value={e.code} onClick={a => fixTruck(a.target.value)}>Fix Truck</button>}\n\n\n                    </div>\n                        </div>\n                    </div>\n                    </div>)}\n                </div>\n            </div>\n        </div>\n    </div>    \n\n    )\n}\n\nexport default Info;"]},"metadata":{},"sourceType":"module"}