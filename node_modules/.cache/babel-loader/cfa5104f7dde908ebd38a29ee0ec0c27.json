{"ast":null,"code":"import _slicedToArray from \"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea-3-t-schilling/cliente/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea-3-t-schilling/cliente/src/componentes/Chat.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport socket from './Socket';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Chat = function Chat(_ref) {\n  _s();\n\n  var username = _ref.username;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      mensaje = _useState2[0],\n      setMensaje = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      mensajes = _useState4[0],\n      setMensajes = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      trucks = _useState6[0],\n      setTrucks = _useState6[1];\n\n  var _useState7 = useState([[]]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      positions = _useState8[0],\n      setPosition = _useState8[1];\n\n  useEffect(function () {\n    console.log('recibiendo mensajes');\n    socket.on('CHAT', function (_ref2) {\n      var date = _ref2.date,\n          message = _ref2.message,\n          name = _ref2.name;\n      console.log(name + ':' + message + '->(' + date + ')');\n      setMensajes(mensajes.concat({\n        date: date,\n        message: message,\n        name: name\n      }));\n    });\n    return function () {\n      socket.off('CHAT');\n    };\n  }, [mensajes]);\n  useEffect(function () {\n    console.log('Recibiendo info de TRUCKS');\n    socket.on('TRUCKS', function (truck) {\n      setTrucks(trucks.concat(truck));\n    });\n    return function () {\n      socket.off();\n    };\n  }, [trucks]);\n  useEffect(function () {\n    socket.on('POSITION', function (_ref3) {\n      var code = _ref3.code,\n          position = _ref3.position;\n      setPosition(positions.concat({\n        code: code,\n        position: position\n      }));\n    });\n  });\n  useEffect(function () {\n    socket.on('FAILURE', function (_ref4) {\n      var code = _ref4.code,\n          source = _ref4.source;\n      var truck = trucks.find(function (element) {\n        return element.code === code;\n      });\n\n      if (typeof truck === undefined) {\n        return \"Truck not found\";\n      } else {\n        console.log('Actualizando el valor de truck:' + code);\n        truck.status = source;\n      }\n    });\n  });\n  useEffect(function () {\n    socket.on('FIX', function (code) {\n      var truck = trucks.find(function (element) {\n        return element.code === code;\n      });\n\n      if (typeof truck === undefined) {\n        return \"Truck not found\";\n      } else {\n        truck.status = 'Ok';\n      }\n    });\n    return;\n  });\n\n  var submit = function submit(e) {\n    e.preventDefault();\n    console.log({\n      message: mensaje,\n      name: username\n    });\n    socket.emit('CHAT', {\n      message: mensaje,\n      name: username\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 18\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat\",\n      children: mensajes.map(function (e, i) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"(\", e.date, \") -- \", e.name, \": \", e.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 21\n          }, _this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 40\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: submit,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"\",\n        children: \" Escriba su mensaje :\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        name: \"\",\n        id: \"\",\n        cols: \"30\",\n        value: mensaje,\n        onChange: function onChange(e) {\n          return setMensaje(e.target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n        children: \" Enviar mensaje\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 13\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(Chat, \"gXNWVsvZ07fjfQ6Tw5UFSoWoXaY=\");\n\n_c = Chat;\nexport default Chat;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"sources":["/home/thomas/Desktop/XII Semestre/Taller de IntegraciÃ³n/Tarea 3/tarea-3-t-schilling/cliente/src/componentes/Chat.js"],"names":["React","useState","useEffect","socket","Chat","username","mensaje","setMensaje","mensajes","setMensajes","trucks","setTrucks","positions","setPosition","console","log","on","date","message","name","concat","off","truck","code","position","source","find","element","undefined","status","submit","e","preventDefault","emit","map","i","target","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport socket from './Socket';\n\nconst Chat = ({username}) => {\n     \n    const [mensaje, setMensaje] = useState('');\n    const[mensajes, setMensajes] = useState([]);\n\n    const[trucks, setTrucks] = useState([]);\n    const[positions, setPosition] = useState([[]])\n\n\n    useEffect(() => {\n        console.log('recibiendo mensajes')\n        socket.on('CHAT', ({date, message, name}) => {\n            console.log(name+':'+message + '->('+date+')');\n            setMensajes(mensajes.concat({date, message, name}));\n        });\n        \n        return () => {\n            socket.off('CHAT');\n      };\n    },[mensajes]);\n    \n    \n    useEffect(() => {\n        console.log('Recibiendo info de TRUCKS');\n        socket.on('TRUCKS', truck =>{setTrucks(trucks.concat(truck))});\n        return () => {socket.off()};\n    },[trucks]);\n\n    useEffect(() => {\n        socket.on( 'POSITION', ({code, position}) => {setPosition(positions.concat({code, position}))});\n    });\n\n    useEffect(() => {\n        socket.on('FAILURE', ({code, source}) => { \n            let truck  = trucks.find(element => element.code === code);\n            if (typeof(truck) === undefined){\n                return \"Truck not found\";\n            }\n            else{\n                console.log('Actualizando el valor de truck:' + code);\n                truck.status = source;\n            }\n        });\n    });\n\n    useEffect(() => {\n        socket.on('FIX', (code) =>{\n            let truck  = trucks.find(element => element.code === code);\n            if (typeof(truck) === undefined){\n                return \"Truck not found\";\n            }\n            else{\n                truck.status = 'Ok';\n            }\n        }); \n        return\n    });\n\n\n    const submit = (e) => {\n        e.preventDefault();\n        console.log({message : mensaje, name : username})\n        socket.emit('CHAT', {message : mensaje, name : username})\n    }\n\n\n    return (\n\n        <div>\n            <div><h2>Chat</h2></div>\n            <div className=\"chat\"> \n                {mensajes.map((e,i) => <div  key={i}> \n                    <div>({e.date}) -- {e.name}: {e.message}</div>\n                </div>)}\n            </div>\n            <form onSubmit={submit}>\n                <label htmlFor=\"\"> Escriba su mensaje : \n                </label>\n                <textarea name=\"\" id=\"\" cols=\"30\" value={mensaje} onChange={e => setMensaje(e.target.value)}>\n\n                </textarea>\n            <button> Enviar mensaje</button>\n\n\n            </form>\n\n        </div>\n    )\n}\n\nexport default Chat;"]},"metadata":{},"sourceType":"module"}