{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea3-IIC3103/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/home/thomas/Desktop/XII Semestre/Taller de Integraci\\xF3n/Tarea 3/tarea3-IIC3103/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import socket from'./Socket';import{MapContainer,TileLayer,Polyline,Tooltip,Marker,Circle}from'react-leaflet';import'./Map.css';import'./../App.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Info=function Info(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),trucks=_useState2[0],setTrucks=_useState2[1];var _useState3=useState([[]]),_useState4=_slicedToArray(_useState3,2),positions=_useState4[0],setPosition=_useState4[1];useEffect(function(){console.log('Recibiendo info de TRUCKS');socket.on('TRUCKS',function(truck){//console.log('--->el code es' + truck[0].code)\nsetTrucks(trucks.concat(truck));});return function(){socket.off('TRUCKS');};},[trucks]);useEffect(function(){socket.on('POSITION',function(obj){setPosition(positions.concat([{code:obj.code,position:obj.position}]));var truck=trucks.find(function(element){return element.code===obj.code;});if(truck===undefined){console.log(\"Truck not found\");}else{truck.position=obj.position;//console.log('Nueva posicion de: ' + truck.truck + '['+ truck.position+ ']');\n}});return function(){socket.off('POSITION');};});useEffect(function(){socket.on('FAILURE',function(_ref){var code=_ref.code,source=_ref.source;var truck=trucks.find(function(element){return element.code===code;});if(typeof truck===undefined){return\"Truck not found\";}else{truck.status=source;}});return function(){socket.off('FAILURE');};});useEffect(function(){socket.on('FIX',function(truck_object){console.log('solucionando el problema de: '+truck_object.code);var truck=trucks.find(function(element){return element.code===truck_object.code;});if(typeof truck===undefined){return\"Truck not found\";}else{truck.status='Ok';}});return function(){socket.off('FIX');};});var truckInfo=function truckInfo(code){var truck=trucks.find(function(element){return element.code===code;});//console.log(truck)\nif(truck===undefined){return\"Truck not found\";}//console.log('ahora tenemos' + truck)\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"'Truck:' \",truck.truck]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"'Code: '\",truck.code]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"'Origin: '\",truck.origin,\"' -- Destination: '\",truck.destination]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"'Status: '\",truck.status]}),\" \",/*#__PURE__*/_jsx(\"br\",{})]});};var fixTruck=function fixTruck(e){//console.log('Vamos a reparar el siguiente camion: ' + e);\nsocket.emit('FIX',{code:e});};var changeStatus=function changeStatus(){var _iterator=_createForOfIteratorHelper(trucks),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var element=_step.value;if(element.status==undefined||element.status==''){element.status='Ok';}}}catch(err){_iterator.e(err);}finally{_iterator.f();}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mapArea\",children:/*#__PURE__*/_jsxs(MapContainer,{center:[-21.976193,-68.79],zoom:11,scrollWheelZoom:false,children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),trucks.map(function(dat){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Polyline,{pathOptions:{color:'black'},positions:[dat.origin,dat.destination]})},dat.code);})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"infoArea\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"info_titulo\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Trucks Information:\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"solo_info\",children:trucks.map(function(e,i){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"truckInfo_container\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Truck: \",e.truck]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Code: \",e.code]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Origin: \",e.origin,\" \"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Destination: \",e.destination,\" \"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Status: \",e.status,\" \"]}),/*#__PURE__*/_jsx(\"div\",{children:e.status!=='Ok'&&/*#__PURE__*/_jsx(\"button\",{value:e.code,onClick:function onClick(a){return fixTruck(a.target.value);},children:\"Fix Truck\"})})]})})},i);})})]})})]});};export default Info;","map":{"version":3,"sources":["/home/thomas/Desktop/XII Semestre/Taller de IntegraciÃ³n/Tarea 3/tarea3-IIC3103/src/componentes/Info.js"],"names":["React","useState","useEffect","socket","MapContainer","TileLayer","Polyline","Tooltip","Marker","Circle","Info","trucks","setTrucks","positions","setPosition","console","log","on","truck","concat","off","obj","code","position","find","element","undefined","source","status","truck_object","truckInfo","origin","destination","fixTruck","e","emit","changeStatus","map","dat","color","i","a","target","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport socket from './Socket';\nimport { MapContainer, TileLayer, Polyline, Tooltip, Marker, Circle} from 'react-leaflet';\nimport './Map.css';\nimport './../App.css'\n\nconst Info = () => {\n\n    const[trucks, setTrucks] = useState([]);\n    const[positions, setPosition] = useState([[]]);\n\n    \n    useEffect(() => {\n        console.log('Recibiendo info de TRUCKS');\n        socket.on('TRUCKS', truck =>{\n            //console.log('--->el code es' + truck[0].code)\n            setTrucks(trucks.concat(truck));\n            \n\n        });\n        return () => {socket.off('TRUCKS')};\n    },[trucks]);\n\n    useEffect(() => {\n        \n        socket.on( 'POSITION', (obj) => {setPosition(positions.concat([{code: obj.code, position : obj.position}]));\n        let truck  = trucks.find(element => element.code === obj.code);\n            if (truck === undefined){\n                console.log( \"Truck not found\");\n            }\n            else{\n                truck.position = obj.position;\n                //console.log('Nueva posicion de: ' + truck.truck + '['+ truck.position+ ']');\n            } \n        });\n        return () => {socket.off('POSITION')};\n    });\n\n    useEffect(() => {\n        socket.on('FAILURE', ({code, source}) => { \n            let truck  = trucks.find(element => element.code === code);\n            if (typeof(truck) === undefined){\n                return \"Truck not found\";\n            }\n            else{\n                truck.status = source;\n            }\n        });\n        return () => {socket.off('FAILURE')}\n    });\n\n    useEffect(() => {\n        socket.on('FIX', (truck_object) =>{\n            console.log('solucionando el problema de: ' + truck_object.code);\n            let truck  = trucks.find(element => element.code === truck_object.code);\n            if (typeof(truck) === undefined){\n                return \"Truck not found\";\n            }\n            else{\n                truck.status = 'Ok';\n            }\n        });\n        return () => {socket.off('FIX')}\n    });\n\n    const truckInfo = (code) => {\n        let truck  = trucks.find(element => element.code === code);\n        //console.log(truck)\n        if (truck === undefined){\n            return (\"Truck not found\");\n        }\n        //console.log('ahora tenemos' + truck)\n        return (<div>\n            <p>'Truck:' {truck.truck}</p><br />\n            <p>'Code: '{truck.code}</p><br />\n            <p>'Origin: '{truck.origin}' -- Destination: '{truck.destination}</p><br />\n            <p>'Status: '{truck.status}</p> <br />\n        </div>)   \n    };\n\n    const fixTruck = (e) =>{\n        //console.log('Vamos a reparar el siguiente camion: ' + e);\n        socket.emit('FIX', {code : e});\n    }\n\n    const changeStatus = () => {\n        for (let element of trucks){\n            if(element.status == undefined || element.status == ''){\n                element.status = 'Ok';\n            }\n        }\n    }\n\n    return (\n        <div>\n            <div className=\"mapArea\">\n                <MapContainer center={[-21.976193,-68.79]} zoom={11} scrollWheelZoom={false}>\n                <TileLayer\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                />\n\n                {trucks.map((dat) => {\n                    return (\n                        <div key={dat.code}>\n                        <Polyline pathOptions={{color:'black'}} positions={[dat.origin, dat.destination]} />\n                        </div>\n                    )\n                })}\n                \n                \n                \n                \n            \n                    \n                </MapContainer>\n            </div>\n\n\n            \n        <div className=\"infoArea\">\n            <div className=\"info_titulo\">\n                <div><h2>Trucks Information:</h2></div>\n                <div className=\"solo_info\"> \n                    {trucks.map((e,i) => <div  key={i}> \n                    <div> \n                        <div className='truckInfo_container'>\n                        <div>Truck: {e.truck}</div>\n                        <div>Code: {e.code}</div>\n                        <div>Origin: {e.origin} </div>\n                        <div>Destination: {e.destination} </div>\n                        <div>Status: {e.status} </div>\n                        <div>\n                        {(e.status !== ('Ok')) && \n                            <button value={e.code} onClick={a => fixTruck(a.target.value)}>Fix Truck</button>}\n\n\n                    </div>\n                        </div>\n                    </div>\n                    </div>)}\n                </div>\n            </div>\n        </div>\n    </div>    \n\n    )\n}\n\nexport default Info;"]},"metadata":{},"sourceType":"module"}